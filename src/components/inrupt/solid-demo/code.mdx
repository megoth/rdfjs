import Content from "../../content";
import Code from "../../code";
import solidDemoCode from "./index.tsx?raw";
import useSolidDataset from "./useSolidDataset.ts?raw";
import solidAlternativeDemo from "./demo.alternative.tsx?raw";
import CodeLink from "../../code-link";
import CodeStep from "../../code/step";

<Content>
    <h2 className="subtitle">Code</h2>

    This demo requires you to authenticate with a Solid account.
</Content>

<Code language="tsx" id="InruptSolidDemo" code={solidDemoCode} className="line-numbers">
    <CodeStep lines={["13-14"]} title="Setting up dataset and session">
        Like with the local demo we set up the `SolidDataset`, but this time we make use of `useSolidAuth` to
        retrieve data about the WebID.
    </CodeStep>
    <CodeStep lines={["15-16"]} title="Getting profile and name">
        This part is also similar to the local part, but since there are some more moving parts with the actual
        fetching of online resources we need to put in some more safeguards.
    </CodeStep>
    <CodeStep lines={["19-20"]} title="Fetching resource and parsing dataset">
        Using `getSolidDataset` we have an easy, asynchronous function to get the dataset.
    </CodeStep>
    <CodeStep lines={["23-25"]} title="Loading state">
        Again, similar approach like the local demo (as well as same flaw, same excuse).
    </CodeStep>
    <CodeStep lines={["28-31"]} title="Updating online resources upon submit">
        Once we submit a name we make sure to update the profile with the updated name, then update the dataset
        with the updated profile, and making a request using `saveSolidDatasetAt` to save the changes to the
        online resource. We then update our local copy of the dataset to make sure all is updated.
    </CodeStep>
</Code>

<Content>
    To be fair to Inrupt's library, <CodeLink id="InruptSolidDemo" lines={["14-15", "25-28", "37-38"]}>a lot of this
    code</CodeLink> can be refactored into the hook `useSolidDataset`:
</Content>

<Code id="UseSolidDataset" language="typescript" code={useSolidDataset} className="line-numbers" />

<Content>
    This way we get a simplified, alternative code for our demo:
</Content>

<Code id="SolidAlternativeDemo" language="tsx" code={solidAlternativeDemo} className="line-numbers" />
